var b;(($)=>{$[$.NONE=0]="NONE";$[$.ERROR=1]="ERROR";$[$.WARNING=2]="WARNING";$[$.INFO=3]="INFO";$[$.DEBUG=4]="DEBUG";$[$.ALL=5]="ALL"})(b||={});class g{static _level=0;static get currentLevel(){return this._level}static level(G){if(typeof G==="number")this._level=G;return this._level}static setLevel(G){this._level=G}static isEnabled(G){return this._level>=G}static log(...G){if(this._level>=4)console.log(...G)}static debug(...G){if(this._level>=4)console.debug(...G)}static info(...G){if(this._level>=3)console.info(...G)}static error(...G){if(this._level>=1)console.error(...G)}static warning(...G){if(this._level>=2)console.warn(...G)}static warn(...G){this.warning(...G)}static table(G,J){if(this._level>=4)console.table(G,J)}static group(...G){if(this._level>=4)console.group(...G)}static groupCollapsed(...G){if(this._level>=4)console.groupCollapsed(...G)}static groupEnd(){if(this._level>=4)console.groupEnd()}static time(G){if(this._level>=4)console.time(G)}static timeLog(G,...J){if(this._level>=4)console.timeLog(G,...J)}static timeEnd(G){if(this._level>=4)console.timeEnd(G)}static trace(...G){if(this._level>=4)console.trace(...G)}static assert(G,...J){if(this._level>=1)console.assert(G,...J)}static clear(){if(this._level>=4)console.clear()}static count(G){if(this._level>=4)console.count(G)}static countReset(G){if(this._level>=4)console.countReset(G)}static dir(G){if(this._level>=4)console.dir(G)}static dirxml(G){if(this._level>=4)console.dirxml(G)}static format(G,...J){let Q=G,X=0;return Q=Q.replace(/%[sdioOcj%]/g,(Y)=>{if(Y==="%%")return"%";if(X>=J.length)return Y;let Z=J[X++];switch(Y){case"%s":return String(Z);case"%d":case"%i":return String(parseInt(String(Z),10));case"%o":case"%O":return JSON.stringify(Z);case"%c":return"";case"%j":return JSON.stringify(Z);default:return Y}}),Q}}var j=new WeakMap;class I{collection;length;constructor(G){if(!G)this.collection=[];else if(typeof G==="string")this.collection=Array.from(document.querySelectorAll(G));else if(G instanceof NodeList)this.collection=Array.from(G);else if(G instanceof I)this.collection=G.collection;else if(G instanceof Element)this.collection=[G];else if(Array.isArray(G))this.collection=G;else this.collection=[];this.length=this.collection.length}hide(){return this.style("display","none")}show(G="block"){return this.style("display",G)}addClass(G){return this.collection.forEach((J)=>J.classList.add(G)),this}removeClass(G){return this.collection.forEach((J)=>{if(!G)J.className="";else J.classList.remove(G)}),this}toggleClass(G){let J=G.split(" ");return this.collection.forEach((Q)=>{J.forEach((X)=>Q.classList.toggle(X))}),this}hasClass(G){return this.collection.every((J)=>J.classList.contains(G))}value(G){if(G!==void 0){let Q=String(G);for(let X of this.collection)if(X instanceof HTMLInputElement||X instanceof HTMLTextAreaElement||X instanceof HTMLSelectElement||X instanceof HTMLButtonElement||X instanceof HTMLOptionElement)X.value=Q;return this}if(this.length===0)return;let J=this.collection[0];if(J instanceof HTMLInputElement||J instanceof HTMLTextAreaElement||J instanceof HTMLSelectElement||J instanceof HTMLButtonElement||J instanceof HTMLOptionElement)return J.value;return}focus(){if(this.length>0)this.collection[0].focus();return this}blur(){if(this.length>0)this.collection[0].blur();return this}click(G){return this.on("click",G)}keyup(G){return this.on("keyup",G)}keydown(G){return this.on("keydown",G)}submit(G){return this.on("submit",G)}change(G){return this.on("change",G)}scroll(G){return this.on("scroll",G)}input(G){return this.on("input",G)}on(G,J,Q){let X=G.split(" "),Y=typeof J==="string",Z=Y?Q:J,$=Y?J:null;if(!Z)return this;return this.collection.forEach((W)=>{X.forEach((B)=>{let _=Y&&$?(A)=>{let z=A.target;if(z instanceof Element){let H=z.closest($);if(H&&W.contains(H))Z.call(H,A)}}:Z;if(!j.has(W))j.set(W,new Map);let U=j.get(W);if(!U.has(B))U.set(B,[]);U.get(B).push({selector:$,originalCallback:Z,wrappedListener:_}),W.addEventListener(B,_,!1)})}),this}off(G,J,Q){return this.collection.forEach((X)=>{let Y=j.get(X);if(!Y)return;let Z=G?G.split(" "):Array.from(Y.keys()),$=typeof J==="string",W=$?J:null,B=$?Q:J;if(Z.forEach((_)=>{let U=Y.get(_);if(!U)return;let A=U.filter((H)=>{if(B&&H.originalCallback!==B)return!1;if(W!==void 0&&H.selector!==W)return!1;return!0});A.forEach((H)=>{X.removeEventListener(_,H.wrappedListener)});let z=U.filter((H)=>!A.includes(H));if(z.length>0)Y.set(_,z);else Y.delete(_)}),Y.size===0)j.delete(X)}),this}trigger(G,J){let Q=G.split(" ");return this.collection.forEach((X)=>{Q.forEach((Y)=>{let Z=J!==void 0?new CustomEvent(Y,{detail:J,bubbles:!0,cancelable:!0}):new Event(Y,{bubbles:!0,cancelable:!0});X.dispatchEvent(Z)})}),this}filter(G){return new I(this.collection.filter((J)=>J.matches(G)))}exists(){return this.length>0}data(G,J){if(J!==void 0)return this.collection.forEach((Q)=>Q.dataset[G]=J),this;return this.length>0?this.collection[0].dataset[G]:void 0}removeData(G){return this.collection.forEach((J)=>delete J.dataset[G]),this}text(G){if(G!==void 0){let J=String(G);for(let Q of this.collection)Q.textContent=J;return this}if(this.length===0)return;return this.collection[0].textContent||""}html(G){if(G!==void 0){let J=String(G);for(let Q of this.collection)Q.innerHTML=J;return this}if(this.length===0)return;return this.collection[0].innerHTML}append(G){return this.collection.forEach((J,Q)=>{if(typeof G==="string")J.insertAdjacentHTML("beforeend",G);else{let X=Q===0?G:G.cloneNode(!0);J.appendChild(X)}}),this}prepend(G){return this.collection.forEach((J,Q)=>{if(typeof G==="string")J.insertAdjacentHTML("afterbegin",G);else{let X=Q===0?G:G.cloneNode(!0);J.prepend(X)}}),this}each(G){return this.collection.forEach((J,Q)=>G(J,Q)),this}get(G){return this.collection[G]}first(){return new I(this.collection[0]??null)}last(){return new I(this.collection[this.collection.length-1]??null)}eq(G){let J=G<0?this.collection.length+G:G;return new I(this.collection[J]??null)}isVisible(){return this.collection.some((G)=>G.style.display!=="none"&&G.offsetWidth>0&&G.offsetHeight>0)}parent(){let G=new Set;return this.collection.forEach((J)=>{if(J.parentElement)G.add(J.parentElement)}),new I(Array.from(G))}parents(){let G=new Set;return this.collection.forEach((J)=>{let Q=J.parentElement;while(Q)G.add(Q),Q=Q.parentElement}),new I(Array.from(G))}find(G){let J=new Set;for(let Q of this.collection){let X=Q.querySelectorAll(G);for(let Y of X)J.add(Y)}return new I(Array.from(J))}offset(){if(this.length===0)return;let G=this.collection[0].getBoundingClientRect();return{top:G.top+window.scrollY,left:G.left+window.scrollX}}width(){if(this.length===0)return 0;return this.collection[0].getBoundingClientRect().width}height(){if(this.length===0)return 0;return this.collection[0].getBoundingClientRect().height}closest(G){let J=new Set;return this.collection.forEach((Q)=>{let X=Q.closest(G);if(X)J.add(X)}),new I(Array.from(J))}attribute(G,J){if(J!==void 0)return this.collection.forEach((Q)=>Q.setAttribute(G,String(J))),this;return this.length>0?this.collection[0].getAttribute(G):void 0}removeAttribute(G){return this.collection.forEach((J)=>J.removeAttribute(G)),this}hasAttribute(G){return this.collection.every((J)=>J.hasAttribute(G))}after(G){return this.collection.forEach((J)=>J.insertAdjacentHTML("afterend",G)),this}before(G){return this.collection.forEach((J)=>J.insertAdjacentHTML("beforebegin",G)),this}style(G,J){if(typeof G==="string"&&J===void 0)return this.length>0?this.collection[0].style.getPropertyValue(G):"";return this.collection.forEach((Q)=>{if(typeof G==="string"&&J!==void 0)Q.style.setProperty(G,J);else if(typeof G==="object")Object.entries(G).forEach(([X,Y])=>{Q.style.setProperty(X,String(Y))})}),this}animate(G,J){return this.collection.forEach((Q)=>Q.animate(G,J)),this}fadeIn(G=400,J){return this.collection.forEach((Q,X)=>{if(getComputedStyle(Q).display==="none")Q.style.display="block";let Y=Q.animate([{opacity:0},{opacity:1}],{duration:G,fill:"forwards"});if(J&&X===this.collection.length-1)Y.onfinish=()=>J()}),this}fadeOut(G=400,J){return this.collection.forEach((Q,X)=>{let Y=Q.animate([{opacity:1},{opacity:0}],{duration:G,fill:"forwards"});Y.onfinish=()=>{if(Q.style.display="none",J&&X===this.collection.length-1)J()}}),this}matches(G){if(this.length===0)return!1;return this.collection.every((J)=>J.matches(G))}remove(){return this.collection.forEach((G)=>G.remove()),this}empty(){return this.collection.forEach((G)=>{G.innerHTML=""}),this}clone(G=!0){let J=this.collection.map((Q)=>Q.cloneNode(G));return new I(J)}replaceWith(G){for(let J=this.collection.length-1;J>=0;J--){let Q=this.collection[J];if(typeof G==="string")Q.outerHTML=G;else{let X=J===0?G:G.cloneNode(!0);Q.replaceWith(X)}}return this}reset(){return this.collection.forEach((G)=>{if(G instanceof HTMLFormElement)G.reset()}),this}property(G,J){if(J!==void 0)return this.collection.forEach((Q)=>{Q[G]=J}),this;if(this.length===0)return;return this.collection[0][G]}siblings(){let G=new Set;return this.collection.forEach((J)=>{if(J.parentElement)Array.from(J.parentElement.children).forEach((Q)=>{if(Q!==J&&Q instanceof HTMLElement)G.add(Q)})}),new I(Array.from(G))}next(){let G=new Set;return this.collection.forEach((J)=>{let Q=J.nextElementSibling;if(Q instanceof HTMLElement)G.add(Q)}),new I(Array.from(G))}prev(){let G=new Set;return this.collection.forEach((J)=>{let Q=J.previousElementSibling;if(Q instanceof HTMLElement)G.add(Q)}),new I(Array.from(G))}children(){let G=new Set;return this.collection.forEach((J)=>{Array.from(J.children).forEach((Q)=>{if(Q instanceof HTMLElement)G.add(Q)})}),new I(Array.from(G))}scrollIntoView(G){if(this.length>0)this.collection[0].scrollIntoView(G);return this}}function c(G){return new I(G)}function u(G){if(document.readyState==="loading")document.addEventListener("DOMContentLoaded",G);else G()}function m(G,J){let Q=document.createElement(G);if(J)Object.entries(J).forEach(([X,Y])=>{Q.setAttribute(X,Y)});return new I(Q)}class L extends Error{status;statusText;response;constructor(G,J){super(J||`Request failed: ${G.status} ${G.statusText}`);this.name="RequestError",this.status=G.status,this.statusText=G.statusText,this.response=G}}class R extends Error{constructor(G,J){super(`Request to "${G}" timed out after ${J}ms`);this.name="RequestTimeoutError"}}class K{static serialize(G,J){if(G instanceof FormData){let X=new URLSearchParams;return G.forEach((Y,Z)=>{if(typeof Y==="string")X.append(Z,Y)}),X.toString()}let Q=[];for(let[X,Y]of Object.entries(G)){if(Y===void 0||Y===null)continue;let Z=J?`${J}[${X}]`:X;if(Array.isArray(Y))Y.forEach(($,W)=>{if(typeof $==="object"&&$!==null)Q.push(K.serialize($,`${Z}[${W}]`));else Q.push(`${encodeURIComponent(Z)}[]=${encodeURIComponent(String($))}`)});else if(typeof Y==="object")Q.push(K.serialize(Y,Z));else Q.push(`${encodeURIComponent(Z)}=${encodeURIComponent(String(Y))}`)}return Q.filter(Boolean).join("&")}static parseUrl(G){try{return new URL(G)}catch{try{return new URL(G,window.location.origin)}catch(J){throw Error(`Invalid URL: "${G}"`)}}}static createTimeoutController(G,J){let Q=new AbortController;if(!G)return{controller:Q};let X=setTimeout(()=>{Q.abort(new R(J,G))},G);return{controller:Q,timeoutId:X}}static async send(G,J,Q={},X={}){let{timeout:Y,...Z}=X,$=K.parseUrl(J),W=void 0,B={...Z.headers};if(["GET","DELETE","HEAD"].includes(G.toUpperCase())){if(Q&&typeof Q==="object"&&!(Q instanceof FormData))Object.entries(Q).forEach(([A,z])=>{if(z!==void 0&&z!==null)$.searchParams.append(A,String(z))})}else{let A=B["Content-Type"]||B["content-type"];if(Q instanceof FormData)delete B["Content-Type"],delete B["content-type"],W=Q;else if(A==="application/json")W=JSON.stringify(Q);else{if(!A)B["Content-Type"]="application/x-www-form-urlencoded";let z=new URLSearchParams;Object.entries(Q).forEach(([H,M])=>z.append(H,String(M))),W=z}}let{controller:_,timeoutId:U}=K.createTimeoutController(Y,J);try{return await fetch($.toString(),{...Z,method:G,headers:B,body:W,signal:_.signal})}finally{if(U)clearTimeout(U)}}static get(G,J={},Q={}){return K.send("GET",G,J,Q)}static post(G,J,Q={}){return K.send("POST",G,J,Q)}static put(G,J,Q={}){return K.send("PUT",G,J,Q)}static patch(G,J,Q={}){return K.send("PATCH",G,J,Q)}static delete(G,J={},Q={}){return K.send("DELETE",G,J,Q)}static head(G,J={},Q={}){return K.send("HEAD",G,J,Q)}static async json(G,J={},Q={}){let X=await K.get(G,J,Q);if(!X.ok)throw new L(X);return X.json()}static async postJson(G,J,Q={}){let X={...Q.headers,"Content-Type":"application/json"},Y=await K.post(G,J,{...Q,headers:X});if(!Y.ok)throw new L(Y);return Y.json()}static async blob(G,J={},Q={}){let X=await K.get(G,J,Q);if(!X.ok)throw new L(X);return X.blob()}static async text(G,J={},Q={}){let X=await K.get(G,J,Q);if(!X.ok)throw new L(X);return X.text()}static async arrayBuffer(G,J={},Q={}){let X=await K.get(G,J,Q);if(!X.ok)throw new L(X);return X.arrayBuffer()}static async exists(G,J={}){try{return(await K.head(G,{},J)).ok}catch{return!1}}}class w{static async readRemote(G,J="base64",Q={}){let X=await K.blob(G,{},Q);return w.read(X,J)}static async read(G,J="text"){switch(J){case"text":return G.text();case"buffer":return G.arrayBuffer();case"base64":return new Promise((Q,X)=>{let Y=new FileReader;Y.onload=()=>Q(Y.result),Y.onerror=()=>X(Y.error),Y.readAsDataURL(G)});case"binary":return new Promise((Q,X)=>{let Y=new FileReader;Y.onload=()=>{let Z=Y.result,$="",W=new Uint8Array(Z),B=W.byteLength;for(let _=0;_<B;_++)$+=String.fromCharCode(W[_]);Q($)},Y.onerror=()=>X(Y.error),Y.readAsArrayBuffer(G)});default:throw Error(`FileSystem.read: Unknown type ${J}`)}}static create(G,J,Q="text/plain"){return new File([J],G,{type:Q})}static download(G,J){let Q=URL.createObjectURL(G),X=document.createElement("a");X.href=Q;let Y;if(J!==void 0&&J!=="")Y=J;else if(G instanceof File&&G.name!=="")Y=G.name;else Y="download";X.download=Y,document.body.appendChild(X),X.click(),document.body.removeChild(X),URL.revokeObjectURL(Q)}static extension(G,J=!1){let Q=G.split(".");if(Q.length===1||Q[0]===""&&Q.length===2&&!J)return"";return Q.pop()?.toLowerCase()??""}static isImage(G){let J=w.extension(G);return new Set(["jpg","jpeg","png","gif","svg","webp","avif","bmp","ico","tiff","heic"]).has(J)}static isVideo(G){let J=w.extension(G);return new Set(["mp4","webm","ogg","mov","avi","mkv","m4v"]).has(J)}static isAudio(G){let J=w.extension(G);return new Set(["mp3","wav","ogg","flac","aac","m4a","wma"]).has(J)}static humanSize(G,J=2){if(G===0)return"0 Bytes";let Q=1024,X=["Bytes","KB","MB","GB","TB","PB"],Y=Math.floor(Math.log(G)/Math.log(Q));return parseFloat((G/Math.pow(Q,Y)).toFixed(J))+" "+X[Y]}}class T{static fill(G,J){let Q=document.querySelector(`form[data-form='${G}']`);if(!Q){console.warn(`Form [data-form='${G}'] not found.`);return}Object.entries(J).forEach(([X,Y])=>{let Z=Q.querySelectorAll(`[name='${X}']`);if(Z.length===0)return;let W=Z[0].type,B=String(Y);switch(W){case"radio":Z.forEach((_)=>{let U=_;if(U.value===B)U.checked=!0});break;case"checkbox":if(Z.length===1)Z[0].checked=!!Y;else if(Array.isArray(Y)){let _=Y.map(String);Z.forEach((U)=>{let A=U;A.checked=_.includes(A.value)})}break;case"file":break;default:Z[0].value=B;break}})}static values(G,J={}){let{parseNumbers:Q=!0,parseBooleans:X=!0}=J,Y=document.querySelector(`form[data-form='${G}']`);if(!Y)return console.warn(`Form [data-form='${G}'] not found.`),{};let Z=new FormData(Y),$={},W=Array.from(new Set(Z.keys()));for(let B of W){let _=Z.getAll(B),U=Y.querySelector(`[name='${B}']`),A=U?.type;if(A==="file"){let z=_.filter((H)=>H instanceof File);if(U?.multiple||z.length>1)$[B]=z;else $[B]=z[0]||null;continue}if(A==="checkbox"){let z=Y.querySelectorAll(`[name='${B}']`);if(z.length===1&&X){$[B]=z[0].checked;continue}$[B]=_.map((H)=>T.parseValue(String(H),Q));continue}if(A==="number"&&Q){if(_.length>1)$[B]=_.map((z)=>parseFloat(String(z)));else $[B]=parseFloat(String(_[0]));continue}if(_.length>1)$[B]=_.map((z)=>T.parseValue(String(z),Q));else $[B]=T.parseValue(String(_[0]),Q)}return $}static parseValue(G,J){if(J&&G!==""&&!isNaN(Number(G)))return Number(G);return G}static reset(G){let J=document.querySelector(`form[data-form='${G}']`);if(!J){console.warn(`Form [data-form='${G}'] not found.`);return}J.reset()}static isValid(G){let J=document.querySelector(`form[data-form='${G}']`);if(!J)return console.warn(`Form [data-form='${G}'] not found.`),!1;return J.checkValidity()}static reportValidity(G){let J=document.querySelector(`form[data-form='${G}']`);if(!J)return console.warn(`Form [data-form='${G}'] not found.`),!1;return J.reportValidity()}}class P{static get retina(){return window.devicePixelRatio>=2}static get portrait(){return window.matchMedia("(orientation: portrait)").matches}static get landscape(){return window.matchMedia("(orientation: landscape)").matches}static get orientation(){return P.portrait?"portrait":"landscape"}static get darkMode(){return window.matchMedia("(prefers-color-scheme: dark)").matches}static get reducedMotion(){return window.matchMedia("(prefers-reduced-motion: reduce)").matches}static get touch(){return"ontouchstart"in window||navigator.maxTouchPoints>0}static get standalone(){let G=navigator;return window.matchMedia("(display-mode: standalone)").matches||G.standalone===!0}static get electron(){let G=window;if(navigator.userAgent.toLowerCase().includes(" electron/"))return!0;if(G.process?.type==="renderer")return!0;if(G.process?.versions?.electron)return!0;return!1}static get cordova(){return!!window.cordova}static get userAgent(){return navigator.userAgent.toLowerCase()}static desktop(G="Any"){let J=navigator;if(J.userAgentData?.mobile===!0)return!1;if(P.isIpadOS())return!1;let Q=P.userAgent,X=J.userAgentData?.platform?.toLowerCase()||"",Y={ChromeOS:X.includes("cros")||Q.includes("cros"),Windows:X.includes("windows")||Q.includes("windows"),macOS:X.includes("macos")||Q.includes("macintosh"),Linux:!Q.includes("android")&&(X.includes("linux")||Q.includes("linux")),FreeBSD:X.includes("freebsd")||Q.includes("freebsd")};if(G==="Any")return Object.values(Y).some((Z)=>Z);return Y[G]||!1}static mobile(G="Any"){if(navigator.userAgentData?.mobile===!0&&G==="Any")return!0;let Q=P.userAgent,X={Android:Q.includes("android"),iOS:/iphone|ipod/.test(Q),iPadOS:P.isIpadOS(),WindowsMobile:/windows phone|iemobile|wpdesktop/.test(Q),BlackBerry:/blackberry|bb10/.test(Q)};if(G==="Any")return Object.values(X).some((Y)=>Y);return X[G]||!1}static isIpadOS(){let G=P.userAgent;if(G.includes("ipad"))return!0;if(G.includes("macintosh")&&navigator.maxTouchPoints>0)return!0;return!1}static get serviceWorkers(){return"serviceWorker"in navigator&&window.isSecureContext}static get coarsePointer(){return window.matchMedia("(pointer: coarse)").matches}static get finePointer(){return window.matchMedia("(pointer: fine)").matches}static get canHover(){return window.matchMedia("(hover: hover)").matches}}class D{static async image(G){let J=new Image;return J.src=G,await J.decode(),J}static async images(G){return Promise.all(G.map((J)=>D.image(J)))}static async file(G,J="low"){let X=await fetch(G,{priority:J});if(!X.ok)throw Error(`Preload failed for "${G}": ${X.status} ${X.statusText}`);return X}static async files(G,J="low"){return Promise.all(G.map((Q)=>D.file(Q,J)))}static async isCached(G,J){if(!("caches"in window))return!1;try{return!!await(await caches.open(G)).match(J)}catch{return!1}}static async addToCache(G,J){if(!("caches"in window))throw Error("Cache API is not supported in this browser");try{await(await caches.open(G)).add(J)}catch(Q){throw Error(`Failed to cache "${J}": ${Q instanceof Error?Q.message:String(Q)}`)}}static async addAllToCache(G,J){if(!("caches"in window))throw Error("Cache API is not supported in this browser");try{await(await caches.open(G)).addAll(J)}catch(Q){throw Error(`Failed to cache URLs: ${Q instanceof Error?Q.message:String(Q)}`)}}static async stylesheet(G){return new Promise((J,Q)=>{let X=document.createElement("link");X.rel="preload",X.as="style",X.href=G,X.onload=()=>J(),X.onerror=()=>Q(Error(`Failed to preload stylesheet: ${G}`)),document.head.appendChild(X)})}static async script(G){return new Promise((J,Q)=>{let X=document.createElement("link");X.rel="preload",X.as="script",X.href=G,X.onload=()=>J(),X.onerror=()=>Q(Error(`Failed to preload script: ${G}`)),document.head.appendChild(X)})}static async font(G,J=!0){return new Promise((Q,X)=>{let Y=document.createElement("link");if(Y.rel="preload",Y.as="font",Y.href=G,J)Y.crossOrigin="anonymous";Y.onload=()=>Q(),Y.onerror=()=>X(Error(`Failed to preload font: ${G}`)),document.head.appendChild(Y)})}}function E(G){if(G==="")return 0;let J=G.split("."),Q=0,X=[1000000000000,1e8,1e4];for(let Y=0;Y<Math.min(J.length,X.length);Y++){let Z=parseInt(J[Y],10)||0;Q+=Z*X[Y]}return Q}function S(G){if(G===null||typeof G!=="object")return G;if(Array.isArray(G))return G.map((Q)=>S(Q));let J={};for(let Q of Object.keys(G))J[Q]=S(G[Q]);return J}function x(G,J){let Q=G.endsWith("/")?G.slice(0,-1):G,X=J.startsWith("/")?J:`/${J}`;return`${Q}${X}`}class O extends Error{constructor(G){super(`Key "${G}" not found in storage`);this.name="KeyNotFoundError"}}class F{name;version;store;id;numericVersion;upgrades;storage;_openPromise;constructor({name:G="",version:J="",store:Q=""}){this.name=G,this.version=J,this.store=Q,this.upgrades={},this.numericVersion=E(J),this.id=this.computeId()}computeId(){if(this.name!==""&&this.version!==""&&this.store!=="")return`${this.name}::${this.store}::${this.version}_`;else if(this.name!==""&&this.version!=="")return`${this.name}::${this.version}_`;else if(this.name!=="")return`${this.name}::_`;else return""}configuration(G){if(G.name!==void 0)this.name=G.name;if(G.version!==void 0)this.version=G.version,this.numericVersion=E(G.version);if(G.store!==void 0)this.store=G.store;this.id=this.computeId()}async open(){if(this.storage instanceof Storage)return this;if(this._openPromise)return this._openPromise;this._openPromise=(async()=>{let G=[];if(this.version!==""){let J="";if(this.name!==""&&this.version!==""&&this.store!=="")J=`${this.name}::${this.store}::`;else if(this.name!==""&&this.version!=="")J=`${this.name}::`;let Q=Object.keys(window.localStorage).filter((X)=>{return X.indexOf(J)===0}).map((X)=>{return X.replace(J,"").split("_")[0]}).filter((X)=>{return X.indexOf("::")===-1}).sort();if(Q.length>0){let X=Q[0],Y=E(X);if(Y<this.numericVersion){let Z=Object.keys(this.upgrades).sort((_,U)=>{let[A]=_.split("::").map(Number),[z]=U.split("::").map(Number);return A-z}),$=Z.findIndex((_)=>{let[U]=_.split("::");return parseInt(U)===Y});if($>-1)G=Z.slice($).filter((_)=>{let[U,A]=_.split("::");return parseInt(U)<this.numericVersion&&parseInt(A)<=this.numericVersion});let W=`${this.name}::${X}_`;if(this.name!==""&&this.version!==""&&this.store!=="")W=`${this.name}::${this.store}::${X}_`;else if(this.name!==""&&this.version!=="")W=`${this.name}::${X}_`;let B=Object.keys(window.localStorage).filter((_)=>{return _.indexOf(W)===0}).map((_)=>{return _.replace(W,"")});for(let _ of B){let U=window.localStorage.getItem(`${W}${_}`);if(U!==null)window.localStorage.setItem(this.id+_,U);window.localStorage.removeItem(`${W}${_}`)}}}}this.storage=window.localStorage;for(let J of G)try{await this.upgrades[J].call(this,this)}catch(Q){console.error(Q)}return this})();try{return await this._openPromise}finally{this._openPromise=void 0}}async set(G,J){if(await this.open(),typeof J==="object")this.storage.setItem(this.id+G,JSON.stringify(J));else this.storage.setItem(this.id+G,String(J));return{key:G,value:J}}async update(G,J){try{let Q=await this.get(G);if(typeof Q==="object"&&Q!==null){if(typeof J==="object"&&J!==null)J={...Q,...J};this.storage.setItem(this.id+G,JSON.stringify(J))}else this.storage.setItem(this.id+G,String(J));return{key:G,value:J}}catch{return this.set(G,J)}}async get(G){await this.open();let J=this.storage.getItem(this.id+G);if(J===null)throw new O(G);try{let Q=JSON.parse(J);if(Q&&typeof Q==="object")return Q;return J}catch{return J}}async getAll(){let G=await this.keys(),J={};for(let Q of G)try{J[Q]=await this.get(Q)}catch{}return J}async contains(G){if((await this.keys()).includes(G))return;else throw new O(G)}async upgrade(G,J,Q){let X=`${E(G)}::${E(J)}`;return this.upgrades[X]=Q,Promise.resolve()}async rename(G){if(this.name===G)throw Error("Cannot rename: new name is identical to current name");let J=await this.keys(),Q=this.id;this.name=G,this.id=this.computeId();for(let X of J){let Y=this.storage.getItem(`${Q}${X}`);if(Y!==null)this.storage.setItem(this.id+X,Y),this.storage.removeItem(`${Q}${X}`)}}async key(G,J=!1){let Q=await this.keys(J);if(G<0||G>=Q.length)throw Error(`Index ${G} out of bounds. Space has ${Q.length} keys.`);return Q[G]}async keys(G=!1){return await this.open(),Object.keys(this.storage).filter((J)=>{return J.indexOf(this.id)===0}).map((J)=>{if(G===!0)return J;else return J.replace(this.id,"")})}async remove(G){let J=await this.get(G);return this.storage.removeItem(this.id+G),J}async clear(){let G=await this.keys();for(let J of G)this.storage.removeItem(this.id+J)}}class C extends F{constructor({name:G="",version:J="",store:Q=""}){super({name:G,version:J,store:Q})}async open(){if(this.storage instanceof Storage)return this;return this.storage=window.sessionStorage,this}async upgrade(G,J,Q){return console.warn("SessionStorage.upgrade() is a no-op. Session data is temporary and does not support migrations."),Promise.resolve()}}class N extends Error{constructor(G){super(`Key "${G}" not found in IndexedDB`);this.name="KeyNotFoundError"}}class q{name;version;store;props;index;keyPath;numericVersion;upgrades;storage;constructor({name:G="",version:J="",store:Q="",props:X={},index:Y={}}){this.name=G,this.version=J,this.store=Q,this.props=X||{},this.index=Y,this.keyPath=X?.keyPath||"id",this.upgrades={},this.numericVersion=E(J)}configuration(G){if(G.name!==void 0)this.name=G.name;if(G.version!==void 0)this.version=G.version,this.numericVersion=E(G.version);if(G.store!==void 0)this.store=G.store}async open(){if(this.name==="")throw Error("IndexedDB requires a name. No name has been defined for this space.");if(this.store==="")throw Error("IndexedDB requires a store name. No store has been defined for this space.");if(this.storage instanceof IDBDatabase)return this;else if(this.storage instanceof Promise)return await this.storage;else{let G=(async()=>{let J,Q=[],X=await new Promise((Y,Z)=>{let $=window.indexedDB.open(this.name,this.numericVersion);$.onerror=(W)=>{Z(Error(`Failed to open IndexedDB "${this.name}": ${W.target.error?.message}`))},$.onsuccess=(W)=>{Y(W.target.result)},$.onupgradeneeded=(W)=>{J=W;let B=W.target.result;if(W.oldVersion<1){let U=B.createObjectStore(this.store,this.props);for(let A of Object.keys(this.index)){let z=this.index[A];U.createIndex(z.name,z.field,z.props)}}else{let U=Object.keys(this.upgrades).sort((z,H)=>{let[M]=z.split("::").map(Number),[f]=H.split("::").map(Number);return M-f}),A=U.findIndex((z)=>{let[H]=z.split("::");return parseInt(H)===W.oldVersion});if(A>-1)Q=U.slice(A).filter((z)=>{let[H,M]=z.split("::");return parseInt(H)<this.numericVersion&&parseInt(M)<=this.numericVersion})}let _=W.target.transaction;if(_)_.addEventListener("complete",()=>{})}});this.storage=X;for(let Y of Q)try{await this.upgrades[Y].call(this,this,J)}catch(Z){console.error(Z)}return this})();return this.storage=G,await G}}async set(G=null,J){return await this.open(),new Promise((Q,X)=>{let Y=this.storage.transaction(this.store,"readwrite").objectStore(this.store),Z;if(G!==null){let $={};$[this.keyPath]=G,Z=Y.put({...$,...J})}else Z=Y.add(J);Z.addEventListener("success",($)=>{Q({key:String($.target.result),value:J})}),Z.addEventListener("error",($)=>{X(Error(`Failed to set key "${G}": ${$.target.error?.message}`))})})}async update(G,J){try{let Q=await this.get(G);if(typeof Q>"u")return this.set(G,J);return new Promise((X,Y)=>{let $=this.storage.transaction(this.store,"readwrite").objectStore(this.store).put({...Q,...J});$.addEventListener("success",(W)=>{X({key:String(W.target.result),value:J})}),$.addEventListener("error",(W)=>{Y(Error(`Failed to update key "${G}": ${W.target.error?.message}`))})})}catch{return this.set(G,J)}}async get(G){return await this.open(),new Promise((J,Q)=>{let Y=this.storage.transaction(this.store,"readonly").objectStore(this.store).get(G);Y.addEventListener("success",(Z)=>{let $=Z.target.result;if(typeof $<"u"&&$!==null)J($);else Q(new N(G))}),Y.addEventListener("error",(Z)=>{Q(Error(`Failed to get key "${G}": ${Z.target.error?.message}`))})})}async getAll(){return await this.open(),new Promise((G,J)=>{let X=this.storage.transaction(this.store,"readonly").objectStore(this.store).getAll();X.addEventListener("success",(Y)=>{let Z={};Y.target.result.forEach((W)=>{let B=W[this.keyPath],_={...W};delete _[this.keyPath],Z[B]=_}),G(Z)}),X.addEventListener("error",(Y)=>{J(Error(`Failed to get all items: ${Y.target.error?.message}`))})})}async contains(G){await this.get(G)}async upgrade(G,J,Q){let X=`${E(G)}::${E(J)}`;return this.upgrades[X]=Q,Promise.resolve()}rename(){return Promise.reject(Error("IndexedDB does not support renaming databases. Create a new database and migrate data manually."))}key(){return Promise.reject(Error("IndexedDB does not support getting keys by index. Use keys() to get all keys."))}async keys(){return await this.open(),new Promise((G,J)=>{let X=this.storage.transaction(this.store,"readonly").objectStore(this.store).getAllKeys();X.addEventListener("success",(Y)=>{G(Y.target.result.map(String))},!1),X.addEventListener("error",(Y)=>{J(Error(`Failed to get keys: ${Y.target.error?.message}`))},!1)})}async remove(G){let J=await this.get(G);return new Promise((Q,X)=>{let Z=this.storage.transaction(this.store,"readwrite").objectStore(this.store).delete(G);Z.addEventListener("success",()=>{Q(J)},!1),Z.addEventListener("error",($)=>{X(Error(`Failed to delete key "${G}": ${$.target.error?.message}`))},!1)})}async clear(){return await this.open(),new Promise((G,J)=>{let X=this.storage.transaction(this.store,"readwrite").objectStore(this.store).clear();X.addEventListener("success",()=>{G()},!1),X.addEventListener("error",(Y)=>{J(Error(`Failed to clear store: ${Y.target.error?.message}`))},!1)})}}class h extends Error{constructor(G){super(`Key "${G}" not found in remote storage`);this.name="KeyNotFoundError"}}class V{name;version;store;baseEndpoint;endpoint;props;storage;constructor({name:G="",version:J="",store:Q="",endpoint:X="",props:Y={}}){this.name=G,this.version=J,this.store=Q,this.baseEndpoint=X,this.endpoint=this.computeEndpoint(),this.props=Y}computeEndpoint(){if(this.store)return x(this.baseEndpoint,`${this.store}/`);return this.baseEndpoint.endsWith("/")?this.baseEndpoint:`${this.baseEndpoint}/`}configuration(G){if(G.name!==void 0)this.name=G.name;if(G.version!==void 0)this.version=G.version;if(G.store!==void 0)this.store=G.store;if(G.endpoint!==void 0)this.baseEndpoint=G.endpoint;this.endpoint=this.computeEndpoint()}async open(){if(typeof this.storage>"u")this.storage=K;return this}async set(G,J){await this.open();let X=await(await this.storage.post(this.endpoint+G,J,this.props)).json();return{key:G,value:X}}async update(G,J){await this.open();let X={...await this.get(G),...J},Z=await(await this.storage.put(this.endpoint+G,X,this.props)).json();return{key:G,value:Z}}async get(G){return await this.open(),this.storage.json(this.endpoint+G,{},this.props)}async getAll(){return await this.open(),this.storage.json(this.endpoint,{},this.props)}async contains(G){if((await this.keys()).includes(G))return;else throw new h(G)}upgrade(){return Promise.reject(Error("RemoteStorage cannot be upgraded from the client. Upgrades must be performed server-side."))}rename(){return Promise.reject(Error("RemoteStorage cannot be renamed from the client. Renaming must be performed server-side."))}key(){return Promise.reject(Error("RemoteStorage does not support getting keys by index. Use keys() to get all keys."))}async keys(){return await this.open(),this.storage.json(this.endpoint,{keys:!0},this.props)}async remove(G){return await this.open(),(await this.storage.delete(this.endpoint+G,{},this.props)).json()}async clear(){await this.open(),await this.storage.delete(this.endpoint,{},this.props)}}var y={LocalStorage:F,SessionStorage:C,IndexedDB:q,RemoteStorage:V};class k{_configuration;adapter;callbacks;transformations;constructor(G=y.LocalStorage,J={}){this._configuration={name:"",version:"",store:"",...J},this.adapter=new G(this._configuration),this.callbacks={create:[],update:[],delete:[]},this.transformations={}}configuration(G=null){if(G!==null){if(this._configuration={...this._configuration,...G},this.adapter.configuration)this.adapter.configuration(G);return}else return this._configuration}async open(){return await this.adapter.open(),this}applySetTransformations(G,J){let Q=S(J);for(let X of Object.values(this.transformations))if(typeof X.set==="function")Q=X.set(G,Q);return Q}applyGetTransformations(G,J){let Q=J;for(let X of Object.values(this.transformations))if(typeof X.get==="function")Q=X.get(G,Q);return Q}async set(G,J){let Q=this.applySetTransformations(G,J),X=await this.adapter.set(G,Q);for(let Y of this.callbacks.create)Y.call(null,X.key,X.value);return X}async update(G,J){let Q=this.applySetTransformations(G,J),X=await this.adapter.update(G,Q);for(let Y of this.callbacks.update)Y.call(null,X.key,X.value);return X}async get(G){let J=await this.adapter.get(G);return this.applyGetTransformations(G,J)}async getAll(){let G=await this.adapter.getAll(),J={};for(let Q of Object.keys(G))J[Q]=this.applyGetTransformations(Q,G[Q]);return J}async each(G){let J=await this.getAll(),Q=[];for(let[X,Y]of Object.entries(J))Q.push(G.call(this,X,Y));return Promise.all(Q)}contains(G){return this.adapter.contains(G)}async upgrade(G,J,Q){return await this.adapter.upgrade(G,J,Q),this}rename(G){return this.adapter.rename(G)}onCreate(G){this.callbacks.create.push(G)}onUpdate(G){this.callbacks.update.push(G)}onDelete(G){this.callbacks.delete.push(G)}addTransformation({id:G,get:J,set:Q}){this.transformations[G]={id:G,get:J,set:Q}}removeTransformation(G){delete this.transformations[G]}key(G,J=!1){return this.adapter.key(G,J)}keys(G=!1){return this.adapter.keys(G)}async remove(G){let J=await this.adapter.remove(G);for(let Q of this.callbacks.delete)Q.call(null,G,J)}clear(){return this.adapter.clear()}}class p{static capitalize(G,J={}){let{preserveCase:Q=!1}=J;return G.replace(/\w\S*/g,(X)=>{let Y=X.charAt(0).toUpperCase(),Z=Q?X.substring(1):X.substring(1).toLowerCase();return Y+Z})}static selection(){return window.getSelection()?.toString()||""}static suffix(G,J){let Q=J.indexOf(G);if(Q===-1)return"";return J.slice(Q+G.length)}static prefix(G,J){let Q=J.indexOf(G);if(Q===-1)return"";return J.slice(0,Q)}static friendly(G){return G.toString().normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase().trim().replace(/\s+/g,"-").replace(/[^\w-]+/g,"").replace(/--+/g,"-")}static truncate(G,J,Q="..."){if(G.length<=J)return G;return G.slice(0,J-Q.length).trimEnd()+Q}static isBlank(G){return G===null||G===void 0||G.trim()===""}}class d{static async callAsync(G,J,...Q){try{return await G.apply(J,Q)}catch(X){return Promise.reject(X)}}static uuid(){if(typeof crypto<"u"&&"randomUUID"in crypto)return crypto.randomUUID();if(typeof crypto<"u"&&"getRandomValues"in crypto)return"10000000-1000-4000-8000-100000000000".replace(/[018]/g,(J)=>{let Q=parseInt(J,10),X=crypto.getRandomValues(new Uint8Array(1))[0],Y=15>>Math.floor(Q/4);return(Q^X&Y).toString(16)});let G=()=>Math.floor((1+Math.random())*65536).toString(16).substring(1);return`${G()}${G()}-${G()}-${G()}-${G()}-${G()}${G()}${G()}`}static debounce(G,J){let Q=null;return(...X)=>{if(Q!==null)clearTimeout(Q);Q=setTimeout(()=>{G(...X),Q=null},J)}}static throttle(G,J){let Q=!1;return(...X)=>{if(!Q)G(...X),Q=!0,setTimeout(()=>{Q=!1},J)}}}export{d as Util,p as Text,y as SpaceAdapter,k as Space,C as SessionStorage,R as RequestTimeoutError,L as RequestError,K as Request,V as RemoteStorage,D as Preload,P as Platform,F as LocalStorage,q as IndexedDB,T as Form,w as FileSystem,b as DebugLevel,g as Debug,I as DOM,u as $_ready,m as $_create,c as $_};

//# debugId=41544FFE055BDA3764756E2164756E21
//# sourceMappingURL=artemis.js.map
