var v=Object.defineProperty;var c=(G,J)=>{for(var Q in J)v(G,Q,{get:J[Q],enumerable:!0,configurable:!0,set:(W)=>J[Q]=()=>W})};var R={};c(R,{Util:()=>p,Text:()=>k,SpaceAdapter:()=>g,Space:()=>y,SessionStorage:()=>T,RequestTimeoutError:()=>D,RequestError:()=>w,Request:()=>U,RemoteStorage:()=>S,Preload:()=>O,Platform:()=>P,LocalStorage:()=>L,IndexedDB:()=>C,Form:()=>j,FileSystem:()=>F,DebugLevel:()=>N,Debug:()=>x,DOM:()=>K,$_ready:()=>u,$_create:()=>i,$_:()=>m});var N;((Z)=>{Z[Z.NONE=0]="NONE";Z[Z.ERROR=1]="ERROR";Z[Z.WARNING=2]="WARNING";Z[Z.INFO=3]="INFO";Z[Z.DEBUG=4]="DEBUG";Z[Z.ALL=5]="ALL"})(N||={});class x{static _level=0;static get currentLevel(){return this._level}static level(G){if(typeof G==="number")this._level=G;return this._level}static setLevel(G){this._level=G}static isEnabled(G){return this._level>=G}static log(...G){if(this._level>=4)console.log(...G)}static debug(...G){if(this._level>=4)console.debug(...G)}static info(...G){if(this._level>=3)console.info(...G)}static error(...G){if(this._level>=1)console.error(...G)}static warning(...G){if(this._level>=2)console.warn(...G)}static warn(...G){this.warning(...G)}static table(G,J){if(this._level>=4)console.table(G,J)}static group(...G){if(this._level>=4)console.group(...G)}static groupCollapsed(...G){if(this._level>=4)console.groupCollapsed(...G)}static groupEnd(){if(this._level>=4)console.groupEnd()}static time(G){if(this._level>=4)console.time(G)}static timeLog(G,...J){if(this._level>=4)console.timeLog(G,...J)}static timeEnd(G){if(this._level>=4)console.timeEnd(G)}static trace(...G){if(this._level>=4)console.trace(...G)}static assert(G,...J){if(this._level>=1)console.assert(G,...J)}static clear(){if(this._level>=4)console.clear()}static count(G){if(this._level>=4)console.count(G)}static countReset(G){if(this._level>=4)console.countReset(G)}static dir(G){if(this._level>=4)console.dir(G)}static dirxml(G){if(this._level>=4)console.dirxml(G)}static format(G,...J){let Q=G,W=0;return Q=Q.replace(/%[sdioOcj%]/g,(X)=>{if(X==="%%")return"%";if(W>=J.length)return X;let Y=J[W++];switch(X){case"%s":return String(Y);case"%d":case"%i":return String(parseInt(String(Y),10));case"%o":case"%O":return JSON.stringify(Y);case"%c":return"";case"%j":return JSON.stringify(Y);default:return X}}),Q}}class K{collection;length;constructor(G){if(!G)this.collection=[];else if(typeof G==="string")this.collection=Array.from(document.querySelectorAll(G));else if(G instanceof NodeList)this.collection=Array.from(G);else if(G instanceof K)this.collection=G.collection;else if(G instanceof Element)this.collection=[G];else if(Array.isArray(G))this.collection=G;else this.collection=[];this.length=this.collection.length}hide(){return this.style("display","none")}show(G="block"){return this.style("display",G)}addClass(G){return this.collection.forEach((J)=>J.classList.add(G)),this}removeClass(G){return this.collection.forEach((J)=>{if(!G)J.className="";else J.classList.remove(G)}),this}toggleClass(G){let J=G.split(" ");return this.collection.forEach((Q)=>{J.forEach((W)=>Q.classList.toggle(W))}),this}hasClass(G){return this.collection.every((J)=>J.classList.contains(G))}value(G){if(G!==void 0){let Q=String(G);for(let W of this.collection)if(W instanceof HTMLInputElement||W instanceof HTMLTextAreaElement||W instanceof HTMLSelectElement||W instanceof HTMLButtonElement||W instanceof HTMLOptionElement)W.value=Q;return this}if(this.length===0)return;let J=this.collection[0];if(J instanceof HTMLInputElement||J instanceof HTMLTextAreaElement||J instanceof HTMLSelectElement||J instanceof HTMLButtonElement||J instanceof HTMLOptionElement)return J.value;return}focus(){if(this.length>0)this.collection[0].focus();return this}blur(){if(this.length>0)this.collection[0].blur();return this}click(G){return this.on("click",G)}keyup(G){return this.on("keyup",G)}keydown(G){return this.on("keydown",G)}submit(G){return this.on("submit",G)}change(G){return this.on("change",G)}scroll(G){return this.on("scroll",G)}input(G){return this.on("input",G)}on(G,J,Q){let W=G.split(" "),X=typeof J==="string",Y=X?Q:J,Z=X?J:null;if(!Y)return this;return this.collection.forEach((H)=>{W.forEach((_)=>{H.addEventListener(_,($)=>{if(X&&Z){let z=$.target;if(z instanceof Element){let A=z.closest(Z);if(A&&H.contains(A))Y.call(A,$)}}else Y.call(H,$)},!1)})}),this}off(G,J){let Q=G.split(" ");return this.collection.forEach((W)=>{Q.forEach((X)=>{W.removeEventListener(X,J)})}),this}trigger(G,J){let Q=G.split(" ");return this.collection.forEach((W)=>{Q.forEach((X)=>{let Y=J!==void 0?new CustomEvent(X,{detail:J,bubbles:!0,cancelable:!0}):new Event(X,{bubbles:!0,cancelable:!0});W.dispatchEvent(Y)})}),this}filter(G){return new K(this.collection.filter((J)=>J.matches(G)))}exists(){return this.length>0}data(G,J){if(J!==void 0)return this.collection.forEach((Q)=>Q.dataset[G]=J),this;return this.length>0?this.collection[0].dataset[G]:void 0}removeData(G){return this.collection.forEach((J)=>delete J.dataset[G]),this}text(G){if(G!==void 0){let J=String(G);for(let Q of this.collection)Q.textContent=J;return this}if(this.length===0)return;return this.collection[0].textContent||""}html(G){if(G!==void 0){let J=String(G);for(let Q of this.collection)Q.innerHTML=J;return this}if(this.length===0)return;return this.collection[0].innerHTML}append(G){return this.collection.forEach((J,Q)=>{if(typeof G==="string")J.insertAdjacentHTML("beforeend",G);else{let W=Q===0?G:G.cloneNode(!0);J.appendChild(W)}}),this}prepend(G){return this.collection.forEach((J,Q)=>{if(typeof G==="string")J.insertAdjacentHTML("afterbegin",G);else{let W=Q===0?G:G.cloneNode(!0);J.prepend(W)}}),this}each(G){return this.collection.forEach((J,Q)=>G(J,Q)),this}get(G){return this.collection[G]}first(){return new K(this.collection[0]??null)}last(){return new K(this.collection[this.collection.length-1]??null)}eq(G){let J=G<0?this.collection.length+G:G;return new K(this.collection[J]??null)}isVisible(){return this.collection.some((G)=>G.style.display!=="none"&&G.offsetWidth>0&&G.offsetHeight>0)}parent(){let G=new Set;return this.collection.forEach((J)=>{if(J.parentElement)G.add(J.parentElement)}),new K(Array.from(G))}parents(){let G=new Set;return this.collection.forEach((J)=>{let Q=J.parentElement;while(Q)G.add(Q),Q=Q.parentElement}),new K(Array.from(G))}find(G){let J=new Set;for(let Q of this.collection){let W=Q.querySelectorAll(G);for(let X of W)J.add(X)}return new K(Array.from(J))}offset(){if(this.length===0)return;let G=this.collection[0].getBoundingClientRect();return{top:G.top+window.scrollY,left:G.left+window.scrollX}}width(){if(this.length===0)return 0;return this.collection[0].getBoundingClientRect().width}height(){if(this.length===0)return 0;return this.collection[0].getBoundingClientRect().height}closest(G){let J=new Set;return this.collection.forEach((Q)=>{let W=Q.closest(G);if(W)J.add(W)}),new K(Array.from(J))}attribute(G,J){if(J!==void 0)return this.collection.forEach((Q)=>Q.setAttribute(G,String(J))),this;return this.length>0?this.collection[0].getAttribute(G):void 0}removeAttribute(G){return this.collection.forEach((J)=>J.removeAttribute(G)),this}hasAttribute(G){return this.collection.every((J)=>J.hasAttribute(G))}after(G){return this.collection.forEach((J)=>J.insertAdjacentHTML("afterend",G)),this}before(G){return this.collection.forEach((J)=>J.insertAdjacentHTML("beforebegin",G)),this}style(G,J){if(typeof G==="string"&&J===void 0)return this.length>0?this.collection[0].style.getPropertyValue(G):"";return this.collection.forEach((Q)=>{if(typeof G==="string"&&J!==void 0)Q.style.setProperty(G,J);else if(typeof G==="object")Object.entries(G).forEach(([W,X])=>{Q.style.setProperty(W,String(X))})}),this}animate(G,J){return this.collection.forEach((Q)=>Q.animate(G,J)),this}fadeIn(G=400,J){return this.collection.forEach((Q,W)=>{if(getComputedStyle(Q).display==="none")Q.style.display="block";let X=Q.animate([{opacity:0},{opacity:1}],{duration:G,fill:"forwards"});if(J&&W===this.collection.length-1)X.onfinish=()=>J()}),this}fadeOut(G=400,J){return this.collection.forEach((Q,W)=>{let X=Q.animate([{opacity:1},{opacity:0}],{duration:G,fill:"forwards"});X.onfinish=()=>{if(Q.style.display="none",J&&W===this.collection.length-1)J()}}),this}matches(G){if(this.length===0)return!1;return this.collection.every((J)=>J.matches(G))}remove(){return this.collection.forEach((G)=>G.remove()),this}empty(){return this.collection.forEach((G)=>{G.innerHTML=""}),this}clone(G=!0){let J=this.collection.map((Q)=>Q.cloneNode(G));return new K(J)}replaceWith(G){for(let J=this.collection.length-1;J>=0;J--){let Q=this.collection[J];if(typeof G==="string")Q.outerHTML=G;else{let W=J===0?G:G.cloneNode(!0);Q.replaceWith(W)}}return this}reset(){return this.collection.forEach((G)=>{if(G instanceof HTMLFormElement)G.reset()}),this}property(G,J){if(J!==void 0)return this.collection.forEach((Q)=>{Q[G]=J}),this;if(this.length===0)return;return this.collection[0][G]}siblings(){let G=new Set;return this.collection.forEach((J)=>{if(J.parentElement)Array.from(J.parentElement.children).forEach((Q)=>{if(Q!==J&&Q instanceof HTMLElement)G.add(Q)})}),new K(Array.from(G))}next(){let G=new Set;return this.collection.forEach((J)=>{let Q=J.nextElementSibling;if(Q instanceof HTMLElement)G.add(Q)}),new K(Array.from(G))}prev(){let G=new Set;return this.collection.forEach((J)=>{let Q=J.previousElementSibling;if(Q instanceof HTMLElement)G.add(Q)}),new K(Array.from(G))}children(){let G=new Set;return this.collection.forEach((J)=>{Array.from(J.children).forEach((Q)=>{if(Q instanceof HTMLElement)G.add(Q)})}),new K(Array.from(G))}scrollIntoView(G){if(this.length>0)this.collection[0].scrollIntoView(G);return this}}function m(G){return new K(G)}function u(G){if(document.readyState==="loading")document.addEventListener("DOMContentLoaded",G);else G()}function i(G,J){let Q=document.createElement(G);if(J)Object.entries(J).forEach(([W,X])=>{Q.setAttribute(W,X)});return new K(Q)}class w extends Error{status;statusText;response;constructor(G,J){super(J||`Request failed: ${G.status} ${G.statusText}`);this.name="RequestError",this.status=G.status,this.statusText=G.statusText,this.response=G}}class D extends Error{constructor(G,J){super(`Request to "${G}" timed out after ${J}ms`);this.name="RequestTimeoutError"}}class U{static serialize(G,J){if(G instanceof FormData){let W=new URLSearchParams;return G.forEach((X,Y)=>{if(typeof X==="string")W.append(Y,X)}),W.toString()}let Q=[];for(let[W,X]of Object.entries(G)){if(X===void 0||X===null)continue;let Y=J?`${J}[${W}]`:W;if(Array.isArray(X))X.forEach((Z,H)=>{if(typeof Z==="object"&&Z!==null)Q.push(U.serialize(Z,`${Y}[${H}]`));else Q.push(`${encodeURIComponent(Y)}[]=${encodeURIComponent(String(Z))}`)});else if(typeof X==="object")Q.push(U.serialize(X,Y));else Q.push(`${encodeURIComponent(Y)}=${encodeURIComponent(String(X))}`)}return Q.filter(Boolean).join("&")}static parseUrl(G){try{return new URL(G)}catch{try{return new URL(G,window.location.origin)}catch(J){throw Error(`Invalid URL: "${G}"`)}}}static createTimeoutController(G,J){let Q=new AbortController;if(!G)return{controller:Q};let W=setTimeout(()=>{Q.abort(new D(J,G))},G);return{controller:Q,timeoutId:W}}static async send(G,J,Q={},W={}){let{timeout:X,...Y}=W,Z=U.parseUrl(J),H=void 0,_={...Y.headers};if(["GET","DELETE","HEAD"].includes(G.toUpperCase())){if(Q&&typeof Q==="object"&&!(Q instanceof FormData))Object.entries(Q).forEach(([A,B])=>{if(B!==void 0&&B!==null)Z.searchParams.append(A,String(B))})}else{let A=_["Content-Type"]||_["content-type"];if(Q instanceof FormData)delete _["Content-Type"],delete _["content-type"],H=Q;else if(A==="application/json")H=JSON.stringify(Q);else{if(!A)_["Content-Type"]="application/x-www-form-urlencoded";let B=new URLSearchParams;Object.entries(Q).forEach(([I,M])=>B.append(I,String(M))),H=B}}let{controller:$,timeoutId:z}=U.createTimeoutController(X,J);try{return await fetch(Z.toString(),{...Y,method:G,headers:_,body:H,signal:$.signal})}finally{if(z)clearTimeout(z)}}static get(G,J={},Q={}){return U.send("GET",G,J,Q)}static post(G,J,Q={}){return U.send("POST",G,J,Q)}static put(G,J,Q={}){return U.send("PUT",G,J,Q)}static patch(G,J,Q={}){return U.send("PATCH",G,J,Q)}static delete(G,J={},Q={}){return U.send("DELETE",G,J,Q)}static head(G,J={},Q={}){return U.send("HEAD",G,J,Q)}static async json(G,J={},Q={}){let W=await U.get(G,J,Q);if(!W.ok)throw new w(W);return W.json()}static async postJson(G,J,Q={}){let W={...Q.headers,"Content-Type":"application/json"},X=await U.post(G,J,{...Q,headers:W});if(!X.ok)throw new w(X);return X.json()}static async blob(G,J={},Q={}){let W=await U.get(G,J,Q);if(!W.ok)throw new w(W);return W.blob()}static async text(G,J={},Q={}){let W=await U.get(G,J,Q);if(!W.ok)throw new w(W);return W.text()}static async arrayBuffer(G,J={},Q={}){let W=await U.get(G,J,Q);if(!W.ok)throw new w(W);return W.arrayBuffer()}static async exists(G,J={}){try{return(await U.head(G,{},J)).ok}catch{return!1}}}class F{static async readRemote(G,J="base64",Q={}){let W=await U.blob(G,{},Q);return F.read(W,J)}static async read(G,J="text"){switch(J){case"text":return G.text();case"buffer":return G.arrayBuffer();case"base64":return new Promise((Q,W)=>{let X=new FileReader;X.onload=()=>Q(X.result),X.onerror=()=>W(X.error),X.readAsDataURL(G)});case"binary":return new Promise((Q,W)=>{let X=new FileReader;X.onload=()=>{let Y=X.result,Z="",H=new Uint8Array(Y),_=H.byteLength;for(let $=0;$<_;$++)Z+=String.fromCharCode(H[$]);Q(Z)},X.onerror=()=>W(X.error),X.readAsArrayBuffer(G)});default:throw Error(`FileSystem.read: Unknown type ${J}`)}}static create(G,J,Q="text/plain"){return new File([J],G,{type:Q})}static download(G,J){let Q=URL.createObjectURL(G),W=document.createElement("a");W.href=Q;let X;if(J!==void 0&&J!=="")X=J;else if(G instanceof File&&G.name!=="")X=G.name;else X="download";W.download=X,document.body.appendChild(W),W.click(),document.body.removeChild(W),URL.revokeObjectURL(Q)}static extension(G,J=!1){let Q=G.split(".");if(Q.length===1||Q[0]===""&&Q.length===2&&!J)return"";return Q.pop()?.toLowerCase()??""}static isImage(G){let J=F.extension(G);return new Set(["jpg","jpeg","png","gif","svg","webp","avif","bmp","ico","tiff","heic"]).has(J)}static isVideo(G){let J=F.extension(G);return new Set(["mp4","webm","ogg","mov","avi","mkv","m4v"]).has(J)}static isAudio(G){let J=F.extension(G);return new Set(["mp3","wav","ogg","flac","aac","m4a","wma"]).has(J)}static humanSize(G,J=2){if(G===0)return"0 Bytes";let Q=1024,W=["Bytes","KB","MB","GB","TB","PB"],X=Math.floor(Math.log(G)/Math.log(Q));return parseFloat((G/Math.pow(Q,X)).toFixed(J))+" "+W[X]}}class j{static fill(G,J){let Q=document.querySelector(`form[data-form='${G}']`);if(!Q){console.warn(`Form [data-form='${G}'] not found.`);return}Object.entries(J).forEach(([W,X])=>{let Y=Q.querySelectorAll(`[name='${W}']`);if(Y.length===0)return;let H=Y[0].type,_=String(X);switch(H){case"radio":Y.forEach(($)=>{let z=$;if(z.value===_)z.checked=!0});break;case"checkbox":if(Y.length===1)Y[0].checked=!!X;else if(Array.isArray(X)){let $=X.map(String);Y.forEach((z)=>{let A=z;A.checked=$.includes(A.value)})}break;case"file":break;default:Y[0].value=_;break}})}static values(G,J={}){let{parseNumbers:Q=!0,parseBooleans:W=!0}=J,X=document.querySelector(`form[data-form='${G}']`);if(!X)return console.warn(`Form [data-form='${G}'] not found.`),{};let Y=new FormData(X),Z={},H=Array.from(new Set(Y.keys()));for(let _ of H){let $=Y.getAll(_),z=X.querySelector(`[name='${_}']`),A=z?.type;if(A==="file"){let B=$.filter((I)=>I instanceof File);if(z?.multiple||B.length>1)Z[_]=B;else Z[_]=B[0]||null;continue}if(A==="checkbox"){let B=X.querySelectorAll(`[name='${_}']`);if(B.length===1&&W){Z[_]=B[0].checked;continue}Z[_]=$.map((I)=>j.parseValue(String(I),Q));continue}if(A==="number"&&Q){if($.length>1)Z[_]=$.map((B)=>parseFloat(String(B)));else Z[_]=parseFloat(String($[0]));continue}if($.length>1)Z[_]=$.map((B)=>j.parseValue(String(B),Q));else Z[_]=j.parseValue(String($[0]),Q)}return Z}static parseValue(G,J){if(J&&G!==""&&!isNaN(Number(G)))return Number(G);return G}static reset(G){let J=document.querySelector(`form[data-form='${G}']`);if(!J){console.warn(`Form [data-form='${G}'] not found.`);return}J.reset()}static isValid(G){let J=document.querySelector(`form[data-form='${G}']`);if(!J)return console.warn(`Form [data-form='${G}'] not found.`),!1;return J.checkValidity()}static reportValidity(G){let J=document.querySelector(`form[data-form='${G}']`);if(!J)return console.warn(`Form [data-form='${G}'] not found.`),!1;return J.reportValidity()}}class P{static get retina(){return window.devicePixelRatio>=2}static get portrait(){return window.matchMedia("(orientation: portrait)").matches}static get landscape(){return window.matchMedia("(orientation: landscape)").matches}static get orientation(){return P.portrait?"portrait":"landscape"}static get darkMode(){return window.matchMedia("(prefers-color-scheme: dark)").matches}static get reducedMotion(){return window.matchMedia("(prefers-reduced-motion: reduce)").matches}static get touch(){return"ontouchstart"in window||navigator.maxTouchPoints>0}static get standalone(){let G=navigator;return window.matchMedia("(display-mode: standalone)").matches||G.standalone===!0}static get electron(){let G=window;if(navigator.userAgent.toLowerCase().includes(" electron/"))return!0;if(G.process?.type==="renderer")return!0;if(G.process?.versions?.electron)return!0;return!1}static get cordova(){return!!window.cordova}static get userAgent(){return navigator.userAgent.toLowerCase()}static desktop(G="Any"){let J=navigator;if(J.userAgentData?.mobile===!0)return!1;if(P.isIpadOS())return!1;let Q=P.userAgent,W=J.userAgentData?.platform?.toLowerCase()||"",X={ChromeOS:W.includes("cros")||Q.includes("cros"),Windows:W.includes("windows")||Q.includes("windows"),macOS:W.includes("macos")||Q.includes("macintosh"),Linux:!Q.includes("android")&&(W.includes("linux")||Q.includes("linux")),FreeBSD:W.includes("freebsd")||Q.includes("freebsd")};if(G==="Any")return Object.values(X).some((Y)=>Y);return X[G]||!1}static mobile(G="Any"){if(navigator.userAgentData?.mobile===!0&&G==="Any")return!0;let Q=P.userAgent,W={Android:Q.includes("android"),iOS:/iphone|ipod/.test(Q),iPadOS:P.isIpadOS(),WindowsMobile:/windows phone|iemobile|wpdesktop/.test(Q),BlackBerry:/blackberry|bb10/.test(Q)};if(G==="Any")return Object.values(W).some((X)=>X);return W[G]||!1}static isIpadOS(){let G=P.userAgent;if(G.includes("ipad"))return!0;if(G.includes("macintosh")&&navigator.maxTouchPoints>0)return!0;return!1}static get serviceWorkers(){return"serviceWorker"in navigator&&window.isSecureContext}static get coarsePointer(){return window.matchMedia("(pointer: coarse)").matches}static get finePointer(){return window.matchMedia("(pointer: fine)").matches}static get canHover(){return window.matchMedia("(hover: hover)").matches}}class O{static async image(G){let J=new Image;return J.src=G,await J.decode(),J}static async images(G){return Promise.all(G.map((J)=>O.image(J)))}static async file(G,J="low"){let W=await fetch(G,{priority:J});if(!W.ok)throw Error(`Preload failed for "${G}": ${W.status} ${W.statusText}`);return W}static async files(G,J="low"){return Promise.all(G.map((Q)=>O.file(Q,J)))}static async isCached(G,J){if(!("caches"in window))return!1;try{return!!await(await caches.open(G)).match(J)}catch{return!1}}static async addToCache(G,J){if(!("caches"in window))throw Error("Cache API is not supported in this browser");try{await(await caches.open(G)).add(J)}catch(Q){throw Error(`Failed to cache "${J}": ${Q instanceof Error?Q.message:String(Q)}`)}}static async addAllToCache(G,J){if(!("caches"in window))throw Error("Cache API is not supported in this browser");try{await(await caches.open(G)).addAll(J)}catch(Q){throw Error(`Failed to cache URLs: ${Q instanceof Error?Q.message:String(Q)}`)}}static async stylesheet(G){return new Promise((J,Q)=>{let W=document.createElement("link");W.rel="preload",W.as="style",W.href=G,W.onload=()=>J(),W.onerror=()=>Q(Error(`Failed to preload stylesheet: ${G}`)),document.head.appendChild(W)})}static async script(G){return new Promise((J,Q)=>{let W=document.createElement("link");W.rel="preload",W.as="script",W.href=G,W.onload=()=>J(),W.onerror=()=>Q(Error(`Failed to preload script: ${G}`)),document.head.appendChild(W)})}static async font(G,J=!0){return new Promise((Q,W)=>{let X=document.createElement("link");if(X.rel="preload",X.as="font",X.href=G,J)X.crossOrigin="anonymous";X.onload=()=>Q(),X.onerror=()=>W(Error(`Failed to preload font: ${G}`)),document.head.appendChild(X)})}}function E(G){if(G==="")return 0;let J=G.split("."),Q=0,W=[1000000000000,1e8,1e4];for(let X=0;X<Math.min(J.length,W.length);X++){let Y=parseInt(J[X],10)||0;Q+=Y*W[X]}return Q}function q(G){if(G===null||typeof G!=="object")return G;if(Array.isArray(G))return G.map((Q)=>q(Q));let J={};for(let Q of Object.keys(G))J[Q]=q(G[Q]);return J}function h(G,J){let Q=G.endsWith("/")?G.slice(0,-1):G,W=J.startsWith("/")?J:`/${J}`;return`${Q}${W}`}class V extends Error{constructor(G){super(`Key "${G}" not found in storage`);this.name="KeyNotFoundError"}}class L{name;version;store;id;numericVersion;upgrades;storage;_openPromise;constructor({name:G="",version:J="",store:Q=""}){this.name=G,this.version=J,this.store=Q,this.upgrades={},this.numericVersion=E(J),this.id=this.computeId()}computeId(){if(this.name!==""&&this.version!==""&&this.store!=="")return`${this.name}::${this.store}::${this.version}_`;else if(this.name!==""&&this.version!=="")return`${this.name}::${this.version}_`;else if(this.name!=="")return`${this.name}::_`;else return""}configuration(G){if(G.name!==void 0)this.name=G.name;if(G.version!==void 0)this.version=G.version,this.numericVersion=E(G.version);if(G.store!==void 0)this.store=G.store;this.id=this.computeId()}async open(){if(this.storage instanceof Storage)return this;if(this._openPromise)return this._openPromise;this._openPromise=(async()=>{let G=[];if(this.version!==""){let J="";if(this.name!==""&&this.version!==""&&this.store!=="")J=`${this.name}::${this.store}::`;else if(this.name!==""&&this.version!=="")J=`${this.name}::`;let Q=Object.keys(window.localStorage).filter((W)=>{return W.indexOf(J)===0}).map((W)=>{return W.replace(J,"").split("_")[0]}).filter((W)=>{return W.indexOf("::")===-1}).sort();if(Q.length>0){let W=Q[0],X=E(W);if(X<this.numericVersion){let Y=Object.keys(this.upgrades).sort(($,z)=>{let[A]=$.split("::").map(Number),[B]=z.split("::").map(Number);return A-B}),Z=Y.findIndex(($)=>{let[z]=$.split("::");return parseInt(z)===X});if(Z>-1)G=Y.slice(Z).filter(($)=>{let[z,A]=$.split("::");return parseInt(z)<this.numericVersion&&parseInt(A)<=this.numericVersion});let H=`${this.name}::${W}_`;if(this.name!==""&&this.version!==""&&this.store!=="")H=`${this.name}::${this.store}::${W}_`;else if(this.name!==""&&this.version!=="")H=`${this.name}::${W}_`;let _=Object.keys(window.localStorage).filter(($)=>{return $.indexOf(H)===0}).map(($)=>{return $.replace(H,"")});for(let $ of _){let z=window.localStorage.getItem(`${H}${$}`);if(z!==null)window.localStorage.setItem(this.id+$,z);window.localStorage.removeItem(`${H}${$}`)}}}}this.storage=window.localStorage;for(let J of G)try{await this.upgrades[J].call(this,this)}catch(Q){console.error(Q)}return this})();try{return await this._openPromise}finally{this._openPromise=void 0}}async set(G,J){if(await this.open(),typeof J==="object")this.storage.setItem(this.id+G,JSON.stringify(J));else this.storage.setItem(this.id+G,String(J));return{key:G,value:J}}async update(G,J){try{let Q=await this.get(G);if(typeof Q==="object"&&Q!==null){if(typeof J==="object"&&J!==null)J={...Q,...J};this.storage.setItem(this.id+G,JSON.stringify(J))}else this.storage.setItem(this.id+G,String(J));return{key:G,value:J}}catch{return this.set(G,J)}}async get(G){await this.open();let J=this.storage.getItem(this.id+G);if(J===null)throw new V(G);try{let Q=JSON.parse(J);if(Q&&typeof Q==="object")return Q;return J}catch{return J}}async getAll(){let G=await this.keys(),J={};for(let Q of G)try{J[Q]=await this.get(Q)}catch{}return J}async contains(G){if((await this.keys()).includes(G))return;else throw new V(G)}async upgrade(G,J,Q){let W=`${E(G)}::${E(J)}`;return this.upgrades[W]=Q,Promise.resolve()}async rename(G){if(this.name===G)throw Error("Cannot rename: new name is identical to current name");let J=await this.keys(),Q=this.id;this.name=G,this.id=this.computeId();for(let W of J){let X=this.storage.getItem(`${Q}${W}`);if(X!==null)this.storage.setItem(this.id+W,X),this.storage.removeItem(`${Q}${W}`)}}async key(G,J=!1){let Q=await this.keys(J);if(G<0||G>=Q.length)throw Error(`Index ${G} out of bounds. Space has ${Q.length} keys.`);return Q[G]}async keys(G=!1){return await this.open(),Object.keys(this.storage).filter((J)=>{return J.indexOf(this.id)===0}).map((J)=>{if(G===!0)return J;else return J.replace(this.id,"")})}async remove(G){let J=await this.get(G);return this.storage.removeItem(this.id+G),J}async clear(){let G=await this.keys();for(let J of G)this.storage.removeItem(this.id+J)}}class T extends L{constructor({name:G="",version:J="",store:Q=""}){super({name:G,version:J,store:Q})}async open(){if(this.storage instanceof Storage)return this;return this.storage=window.sessionStorage,this}async upgrade(G,J,Q){return console.warn("SessionStorage.upgrade() is a no-op. Session data is temporary and does not support migrations."),Promise.resolve()}}class b extends Error{constructor(G){super(`Key "${G}" not found in IndexedDB`);this.name="KeyNotFoundError"}}class C{name;version;store;props;index;keyPath;numericVersion;upgrades;storage;constructor({name:G="",version:J="",store:Q="",props:W={},index:X={}}){this.name=G,this.version=J,this.store=Q,this.props=W||{},this.index=X,this.keyPath=W?.keyPath||"id",this.upgrades={},this.numericVersion=E(J)}configuration(G){if(G.name!==void 0)this.name=G.name;if(G.version!==void 0)this.version=G.version,this.numericVersion=E(G.version);if(G.store!==void 0)this.store=G.store}async open(){if(this.name==="")throw Error("IndexedDB requires a name. No name has been defined for this space.");if(this.store==="")throw Error("IndexedDB requires a store name. No store has been defined for this space.");if(this.storage instanceof IDBDatabase)return this;else if(this.storage instanceof Promise)return await this.storage;else{let G=(async()=>{let J,Q=[],W=await new Promise((X,Y)=>{let Z=window.indexedDB.open(this.name,this.numericVersion);Z.onerror=(H)=>{Y(Error(`Failed to open IndexedDB "${this.name}": ${H.target.error?.message}`))},Z.onsuccess=(H)=>{X(H.target.result)},Z.onupgradeneeded=(H)=>{J=H;let _=H.target.result;if(H.oldVersion<1){let z=_.createObjectStore(this.store,this.props);for(let A of Object.keys(this.index)){let B=this.index[A];z.createIndex(B.name,B.field,B.props)}}else{let z=Object.keys(this.upgrades).sort((B,I)=>{let[M]=B.split("::").map(Number),[d]=I.split("::").map(Number);return M-d}),A=z.findIndex((B)=>{let[I]=B.split("::");return parseInt(I)===H.oldVersion});if(A>-1)Q=z.slice(A).filter((B)=>{let[I,M]=B.split("::");return parseInt(I)<this.numericVersion&&parseInt(M)<=this.numericVersion})}let $=H.target.transaction;if($)$.addEventListener("complete",()=>{})}});this.storage=W;for(let X of Q)try{await this.upgrades[X].call(this,this,J)}catch(Y){console.error(Y)}return this})();return this.storage=G,await G}}async set(G=null,J){return await this.open(),new Promise((Q,W)=>{let X=this.storage.transaction(this.store,"readwrite").objectStore(this.store),Y;if(G!==null){let Z={};Z[this.keyPath]=G,Y=X.put({...Z,...J})}else Y=X.add(J);Y.addEventListener("success",(Z)=>{Q({key:String(Z.target.result),value:J})}),Y.addEventListener("error",(Z)=>{W(Error(`Failed to set key "${G}": ${Z.target.error?.message}`))})})}async update(G,J){try{let Q=await this.get(G);if(typeof Q>"u")return this.set(G,J);return new Promise((W,X)=>{let Z=this.storage.transaction(this.store,"readwrite").objectStore(this.store).put({...Q,...J});Z.addEventListener("success",(H)=>{W({key:String(H.target.result),value:J})}),Z.addEventListener("error",(H)=>{X(Error(`Failed to update key "${G}": ${H.target.error?.message}`))})})}catch{return this.set(G,J)}}async get(G){return await this.open(),new Promise((J,Q)=>{let X=this.storage.transaction(this.store,"readonly").objectStore(this.store).get(G);X.addEventListener("success",(Y)=>{let Z=Y.target.result;if(typeof Z<"u"&&Z!==null)J(Z);else Q(new b(G))}),X.addEventListener("error",(Y)=>{Q(Error(`Failed to get key "${G}": ${Y.target.error?.message}`))})})}async getAll(){return await this.open(),new Promise((G,J)=>{let W=this.storage.transaction(this.store,"readonly").objectStore(this.store).getAll();W.addEventListener("success",(X)=>{let Y={};X.target.result.forEach((H)=>{let _=H[this.keyPath],$={...H};delete $[this.keyPath],Y[_]=$}),G(Y)}),W.addEventListener("error",(X)=>{J(Error(`Failed to get all items: ${X.target.error?.message}`))})})}async contains(G){await this.get(G)}async upgrade(G,J,Q){let W=`${E(G)}::${E(J)}`;return this.upgrades[W]=Q,Promise.resolve()}rename(){return Promise.reject(Error("IndexedDB does not support renaming databases. Create a new database and migrate data manually."))}key(){return Promise.reject(Error("IndexedDB does not support getting keys by index. Use keys() to get all keys."))}async keys(){return await this.open(),new Promise((G,J)=>{let W=this.storage.transaction(this.store,"readonly").objectStore(this.store).getAllKeys();W.addEventListener("success",(X)=>{G(X.target.result.map(String))},!1),W.addEventListener("error",(X)=>{J(Error(`Failed to get keys: ${X.target.error?.message}`))},!1)})}async remove(G){let J=await this.get(G);return new Promise((Q,W)=>{let Y=this.storage.transaction(this.store,"readwrite").objectStore(this.store).delete(G);Y.addEventListener("success",()=>{Q(J)},!1),Y.addEventListener("error",(Z)=>{W(Error(`Failed to delete key "${G}": ${Z.target.error?.message}`))},!1)})}async clear(){return await this.open(),new Promise((G,J)=>{let W=this.storage.transaction(this.store,"readwrite").objectStore(this.store).clear();W.addEventListener("success",()=>{G()},!1),W.addEventListener("error",(X)=>{J(Error(`Failed to clear store: ${X.target.error?.message}`))},!1)})}}class f extends Error{constructor(G){super(`Key "${G}" not found in remote storage`);this.name="KeyNotFoundError"}}class S{name;version;store;baseEndpoint;endpoint;props;storage;constructor({name:G="",version:J="",store:Q="",endpoint:W="",props:X={}}){this.name=G,this.version=J,this.store=Q,this.baseEndpoint=W,this.endpoint=this.computeEndpoint(),this.props=X}computeEndpoint(){if(this.store)return h(this.baseEndpoint,`${this.store}/`);return this.baseEndpoint.endsWith("/")?this.baseEndpoint:`${this.baseEndpoint}/`}configuration(G){if(G.name!==void 0)this.name=G.name;if(G.version!==void 0)this.version=G.version;if(G.store!==void 0)this.store=G.store;if(G.endpoint!==void 0)this.baseEndpoint=G.endpoint;this.endpoint=this.computeEndpoint()}async open(){if(typeof this.storage>"u")this.storage=U;return this}async set(G,J){await this.open();let W=await(await this.storage.post(this.endpoint+G,J,this.props)).json();return{key:G,value:W}}async update(G,J){await this.open();let W={...await this.get(G),...J},Y=await(await this.storage.put(this.endpoint+G,W,this.props)).json();return{key:G,value:Y}}async get(G){return await this.open(),this.storage.json(this.endpoint+G,{},this.props)}async getAll(){return await this.open(),this.storage.json(this.endpoint,{},this.props)}async contains(G){if((await this.keys()).includes(G))return;else throw new f(G)}upgrade(){return Promise.reject(Error("RemoteStorage cannot be upgraded from the client. Upgrades must be performed server-side."))}rename(){return Promise.reject(Error("RemoteStorage cannot be renamed from the client. Renaming must be performed server-side."))}key(){return Promise.reject(Error("RemoteStorage does not support getting keys by index. Use keys() to get all keys."))}async keys(){return await this.open(),this.storage.json(this.endpoint,{keys:!0},this.props)}async remove(G){return await this.open(),(await this.storage.delete(this.endpoint+G,{},this.props)).json()}async clear(){await this.open(),await this.storage.delete(this.endpoint,{},this.props)}}var g={LocalStorage:L,SessionStorage:T,IndexedDB:C,RemoteStorage:S};class y{_configuration;adapter;callbacks;transformations;constructor(G=g.LocalStorage,J={}){this._configuration={name:"",version:"",store:"",...J},this.adapter=new G(this._configuration),this.callbacks={create:[],update:[],delete:[]},this.transformations={}}configuration(G=null){if(G!==null){if(this._configuration={...this._configuration,...G},this.adapter.configuration)this.adapter.configuration(G);return}else return this._configuration}async open(){return await this.adapter.open(),this}applySetTransformations(G,J){let Q=q(J);for(let W of Object.values(this.transformations))if(typeof W.set==="function")Q=W.set(G,Q);return Q}applyGetTransformations(G,J){let Q=J;for(let W of Object.values(this.transformations))if(typeof W.get==="function")Q=W.get(G,Q);return Q}async set(G,J){let Q=this.applySetTransformations(G,J),W=await this.adapter.set(G,Q);for(let X of this.callbacks.create)X.call(null,W.key,W.value);return W}async update(G,J){let Q=this.applySetTransformations(G,J),W=await this.adapter.update(G,Q);for(let X of this.callbacks.update)X.call(null,W.key,W.value);return W}async get(G){let J=await this.adapter.get(G);return this.applyGetTransformations(G,J)}async getAll(){let G=await this.adapter.getAll(),J={};for(let Q of Object.keys(G))J[Q]=this.applyGetTransformations(Q,G[Q]);return J}async each(G){let J=await this.getAll(),Q=[];for(let[W,X]of Object.entries(J))Q.push(G.call(this,W,X));return Promise.all(Q)}contains(G){return this.adapter.contains(G)}async upgrade(G,J,Q){return await this.adapter.upgrade(G,J,Q),this}rename(G){return this.adapter.rename(G)}onCreate(G){this.callbacks.create.push(G)}onUpdate(G){this.callbacks.update.push(G)}onDelete(G){this.callbacks.delete.push(G)}addTransformation({id:G,get:J,set:Q}){this.transformations[G]={id:G,get:J,set:Q}}removeTransformation(G){delete this.transformations[G]}key(G,J=!1){return this.adapter.key(G,J)}keys(G=!1){return this.adapter.keys(G)}async remove(G){let J=await this.adapter.remove(G);for(let Q of this.callbacks.delete)Q.call(null,G,J)}clear(){return this.adapter.clear()}}class k{static capitalize(G,J={}){let{preserveCase:Q=!1}=J;return G.replace(/\w\S*/g,(W)=>{let X=W.charAt(0).toUpperCase(),Y=Q?W.substring(1):W.substring(1).toLowerCase();return X+Y})}static selection(){return window.getSelection()?.toString()||""}static suffix(G,J){let Q=J.indexOf(G);if(Q===-1)return"";return J.slice(Q+G.length)}static prefix(G,J){let Q=J.indexOf(G);if(Q===-1)return"";return J.slice(0,Q)}static friendly(G){return G.toString().normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase().trim().replace(/\s+/g,"-").replace(/[^\w-]+/g,"").replace(/--+/g,"-")}static truncate(G,J,Q="..."){if(G.length<=J)return G;return G.slice(0,J-Q.length).trimEnd()+Q}static isBlank(G){return G===null||G===void 0||G.trim()===""}}class p{static async callAsync(G,J,...Q){try{return await G.apply(J,Q)}catch(W){return Promise.reject(W)}}static uuid(){if(typeof crypto<"u"&&"randomUUID"in crypto)return crypto.randomUUID();if(typeof crypto<"u"&&"getRandomValues"in crypto)return"10000000-1000-4000-8000-100000000000".replace(/[018]/g,(J)=>{let Q=parseInt(J,10),W=crypto.getRandomValues(new Uint8Array(1))[0],X=15>>Math.floor(Q/4);return(Q^W&X).toString(16)});let G=()=>Math.floor((1+Math.random())*65536).toString(16).substring(1);return`${G()}${G()}-${G()}-${G()}-${G()}-${G()}${G()}${G()}`}static debounce(G,J){let Q=null;return(...W)=>{if(Q!==null)clearTimeout(Q);Q=setTimeout(()=>{G(...W),Q=null},J)}}static throttle(G,J){let Q=!1;return(...W)=>{if(!Q)G(...W),Q=!0,setTimeout(()=>{Q=!1},J)}}}if(typeof window==="object")window.Artemis=R;

//# debugId=5F3D30EB8865BDBD64756E2164756E21
//# sourceMappingURL=artemis.browser.js.map
